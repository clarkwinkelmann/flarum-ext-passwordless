(()=>{var s={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},d:(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},o:(s,e)=>Object.prototype.hasOwnProperty.call(s,e),r:s=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})}},e={};(()=>{"use strict";s.r(e);const t=flarum.core.compat["common/extend"],o=flarum.core.compat["forum/app"];var r=s.n(o);const a=flarum.core.compat["forum/components/LogInModal"];var i=s.n(a);const n=flarum.core.compat["forum/components/SignUpModal"];var d=s.n(n),l="clarkwinkelmann-passwordless.forum.sign-up.";r().initializers.add("clarkwinkelmann-passwordless",(function(){(0,t.extend)(i().prototype,"oninit",(function(){this.passwordlessTokenSent=!1,this.passwordlessSkip=!r().forum.attribute("passwordless.passwordlessLoginByDefault")})),(0,t.extend)(i().prototype,"fields",(function(s){this.passwordlessTokenSent?(s.add("passwordless",m("p",r().translator.trans(l+"link-sent",{a:m("a",{onclick:this.requestPasswordlessToken.bind(this)})})),100),s.has("identification")&&s.remove("identification"),s.has("remember")&&s.remove("remember"),s.has("submit")&&s.remove("submit")):this.passwordlessSkip||s.add("passwordless",m("p",r().translator.trans(l+"how-it-works")),-100),this.passwordlessSkip||(s.has("password")&&s.remove("password"),s.has("identification")&&s.get("identification")&&Array.isArray(s.get("identification").children)&&s.get("identification").children.forEach((function(s){s&&s.attrs&&"identification"===s.attrs.name&&(s.attrs.placeholder=r().translator.trans(l+"email"),s.attrs.type="email")})))})),(0,t.extend)(i().prototype,"footer",(function(s){var e=this;!this.passwordlessSkip&&Array.isArray(s)&&s.length&&s[0]&&s[0].attrs&&"LogInModal-forgotPassword"===s[0].attrs.className&&s.splice(0,1),s.push(m("p",r().translator.trans(l+(this.passwordlessSkip?"login-without-password":"login-with-password"),{a:m("a",{onclick:function(){e.passwordlessSkip=!e.passwordlessSkip,e.passwordlessTokenSent=!1}})})))})),i().prototype.requestPasswordlessToken=function(s){var e=this;s.preventDefault(),this.loading=!0,r().request({method:"POST",url:r().forum.attribute("apiUrl")+"/passwordless-request",body:{identification:this.identification(),remember:this.remember()},errorHandler:this.onerror.bind(this)}).then((function(){e.passwordlessTokenSent=!0,e.loaded()}),this.loaded.bind(this))},(0,t.override)(i().prototype,"onsubmit",(function(s,e){if(this.passwordlessSkip)return s(e);this.requestPasswordlessToken(e)})),(0,t.extend)(d().prototype,"fields",(function(s){r().forum.attribute("passwordless.hideSignUpPassword")&&s.has("password")&&s.remove("password")}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map